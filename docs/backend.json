{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Base user profile information.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "phone": {
          "type": "string"
        },
        "role": {
          "type": "string",
          "enum": [
            "owner",
            "driver",
            "admin"
          ]
        },
        "isActive": {
          "type": "boolean"
        },
        "avatarUrl": {
          "type": "string",
          "format": "uri"
        },
        "ownerId": {
          "type": "string",
          "description": "UID of the owner this driver belongs to. Only for drivers."
        },
        "subscriptionKey": {
          "type": "string",
          "description": "The last subscription key used by the owner."
        },
        "subscriptionExpiresAt": {
          "type": "string",
          "format": "date-time",
          "description": "The date and time when the user's subscription expires."
        }
      },
      "required": [
        "name",
        "phone",
        "role",
        "isActive"
      ]
    },
    "SubscriptionKey": {
      "title": "Subscription Key",
      "description": "A key that grants access to the service for a limited time.",
      "type": "object",
      "properties": {
        "isUsed": {
          "type": "boolean",
          "description": "Whether this key has been redeemed."
        },
        "usedBy": {
          "type": "string",
          "description": "The UID of the user who redeemed this key."
        },
        "expiresAt": {
          "type": "string",
          "format": "date-time",
          "description": "The date and time when the subscription granted by this key expires."
        }
      },
      "required": [
        "isUsed",
        "expiresAt"
      ]
    },
    "Route": {
      "title": "Route",
      "description": "A transport route from a source to one or more destinations.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "A short, memorable name for the route."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the owner who created this route."
        },
        "source": {
          "type": "string"
        },
        "destinations": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "rate_per_trip": {
          "type": "number"
        },
        "is_active": {
          "type": "boolean"
        },
        "sourceCoords": {
          "type": "object",
          "properties": {
            "latitude": {
              "type": "number"
            },
            "longitude": {
              "type": "number"
            }
          },
          "required": [
            "latitude",
            "longitude"
          ]
        },
        "destCoords": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "latitude": {
                "type": "number"
              },
              "longitude": {
                "type": "number"
              }
            },
            "required": [
              "latitude",
              "longitude"
            ]
          }
        }
      },
      "required": [
        "name",
        "ownerId",
        "source",
        "destinations",
        "rate_per_trip",
        "is_active",
        "sourceCoords",
        "destCoords"
      ]
    },
    "Trip": {
      "title": "Trip",
      "description": "A record of trips made by a driver on a specific date and route.",
      "type": "object",
      "properties": {
        "ownerId": {
          "type": "string",
          "description": "The UID of the owner."
        },
        "driverId": {
          "type": "string",
          "description": "The UID of the driver."
        },
        "date": {
          "type": "string",
          "format": "date-time"
        },
        "routeId": {
          "type": "string"
        },
        "count": {
          "type": "number"
        },
        "jobId": {
          "type": "string",
          "description": "The ID of the job this trip belongs to, if applicable."
        },
        "events": {
          "type": "array",
          "description": "A log of events that occurred during this specific trip.",
          "items": {
            "type": "object",
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time"
              },
              "location": {
                "type": "string",
                "description": "Name of the location (source or destination)."
              },
              "action": {
                "type": "string",
                "description": "Action performed, e.g., 'Water Filled', 'Water Delivered'."
              },
              "notes": {
                "type": "string"
              }
            },
            "required": [
              "timestamp",
              "location",
              "action"
            ]
          }
        }
      },
      "required": [
        "ownerId",
        "driverId",
        "date",
        "routeId",
        "count"
      ]
    },
    "PayoutSlab": {
      "title": "Payout Slab",
      "description": "Configuration for driver payout based on trip count.",
      "type": "object",
      "properties": {
        "ownerId": {
          "type": "string",
          "description": "The UID of the owner."
        },
        "min_trips": {
          "type": "number"
        },
        "max_trips": {
          "type": "number"
        },
        "payout_amount": {
          "type": "number"
        }
      },
      "required": [
        "ownerId",
        "min_trips",
        "max_trips",
        "payout_amount"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores user profile data for all users (owners, drivers, and admins). The document ID is the Firebase Auth UID."
    },
    "/subscriptionKeys/{key}": {
      "schema": {
        "$ref": "#/entities/SubscriptionKey"
      },
      "description": "Stores subscription keys that can be redeemed by owners."
    },
    "/routes/{routeId}": {
      "schema": {
        "$ref": "#/entities/Route"
      },
      "description": "All routes for all owners. The 'ownerId' field (UID) scopes the data."
    },
    "/trips/{tripId}": {
      "schema": {
        "$ref": "#/entities/Trip"
      },
      "description": "All trips for all drivers. The 'ownerId' and 'driverId' fields (UIDs) scope the data."
    },
    "/payoutSlabs/{slabId}": {
      "schema": {
        "$ref": "#/entities/PayoutSlab"
      },
      "description": "All payout slabs. The 'ownerId' field (UID) scopes the data."
    }
  }
}
